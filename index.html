<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ë¬¸ì˜í•˜ê¸°</title>
  
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    (function(){
      emailjs.init("HzYk0wIEOoM4IMMa_");  // EmailJS_Part
    })();
  </script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap');
    * { margin:0; padding:0; box-sizing:border-box; }
    body {
      font-family:'Noto Sans KR',sans-serif;
      background:linear-gradient(135deg,#667eea,#764ba2);
      min-height:100vh; padding:20px;
      display:flex; align-items:center; justify-content:center;
    }
    .card {
      background:#fff; border-radius:24px;
      box-shadow:0 20px 40px rgba(0,0,0,0.15);
      padding:40px 30px; width:100%; max-width:420px; text-align:center;
    }
    h2 { font-size:24px; margin-bottom:8px; color:#333; }
    p.subtitle { color:#888; margin-bottom:32px; font-size:15px; }
    textarea {
      width:100%; min-height:160px; padding:16px; border:2px solid #e1e1e1;
      border-radius:16px; font-size:16px; resize:none; transition:.3s;
    }
    textarea:focus { outline:none; border-color:#667eea; box-shadow:0 0 0 4px rgba(102,126,234,0.15); }
    button {
      margin-top:24px; width:100%; padding:16px; background:linear-gradient(135deg,#667eea,#764ba2);
      color:#fff; border:none; border-radius:16px; font-size:17px; font-weight:600;
      cursor:pointer; box-shadow:0 8px 20px rgba(102,126,234,0.4); transition:.3s;
    }
    button:hover { transform:translateY(-2px); }
    button:disabled {
      background:#aaa; cursor:not-allowed; transform:none;
      box-shadow:none;
    }

    .lang-switch { position:absolute; top:20px; right:20px; }
    .lang-switch button {
      background:none; border:none; font-size:20px; margin:0 4px; cursor:pointer; opacity:0.7;
      transition:opacity .2s;
    }
    .lang-switch button.active { opacity:1; font-weight:bold; }
    .lang-switch button:hover { opacity:1; }

    /* ì–¸ì–´ ì„ íƒê¸° */
    #status { margin-top:20px; font-weight:500; min-height:28px; }
    .success { color:#34c759; }
    .error { color:#ff3b30; }
    .warning { color:#ff9500; }
  </style>
</head>
<body>
  <!-- ì–¸ì–´ ì„ íƒ ë²„íŠ¼ë“¤ -->
  <div class="lang-switch">
    <button onclick="setLang('ko')"   class="lang-btn">í•œêµ­ì–´</button>
    <button onclick="setLang('en')"   class="lang-btn">EN</button>
    <button onclick="setLang('ja')"   class="lang-btn">æ—¥æœ¬èª</button>
  </div>

  <div class="card">
    <h2>ê±´ì˜í•˜ê¸°</h2>
    <p class="subtitle">í¸í•˜ê²Œ ì§ˆë¬¸, ê±´ì˜ ë³´ë‚´ì£¼ì„¸ìš”.<br>ë‹¨ í•˜ë£¨ì— í•œ ë²ˆë§Œ ë³´ë‚´ì‹¤ ìˆ˜ ìˆì–´ìš”ğŸ˜Š</p>
    
    <textarea id="message" placeholder="ë¬´ìŠ¨ ì¼ì´ ìˆë‚˜ìš”? ğŸ˜Š"></textarea>
    
    <button id="sendBtn" onclick="sendEmail()">ì „ì†¡í•˜ê¸°</button>
    
    <div id="status"></div>
  </div>

  <script>
    const STORAGE_KEY = "daily_email_sent_date";   // ì´ í‚¤ë¡œ ì˜¤ëŠ˜ ë³´ëƒˆëŠ”ì§€ ì²´í¬
    const translations = {
      ko: {
        title: "ë¬¸ì˜í•˜ê¸°",
        subtitle: "í•˜ë£¨ì— í•œ ë²ˆë§Œ ë³´ë‚´ì‹¤ ìˆ˜ ìˆì–´ìš”<br>ì •ë§ ì¤‘ìš”í•œ ë‚´ìš©ë§Œ ë¶€íƒë“œë¦´ê²Œìš”",
        placeholder: "ë¬´ìŠ¨ ì¼ì´ ìˆë‚˜ìš”?",
        send: "ì „ì†¡í•˜ê¸°",
        sent_today: "ì˜¤ëŠ˜ì€ ì´ë¯¸ ì „ì†¡í•˜ì…¨ìŠµë‹ˆë‹¤<br><small>ë‚´ì¼ ë‹¤ì‹œ ì™€ì£¼ì„¸ìš”</small>",
        success: "ì„±ê³µì ìœ¼ë¡œ ì „ì†¡ë˜ì—ˆìŠµë‹ˆë‹¤!<br><small>í•˜ë£¨ í•œ ë²ˆ ê°ì‚¬í•©ë‹ˆë‹¤</small>",
        error_empty: "ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!",
        sending: "ì „ì†¡ ì¤‘..."
      },
      en: {
        title: "Contact Me",
        subtitle: "One message per day only<br>Please send only important messages",
        placeholder: "What's on your mind?",
        send: "Send Message",
        sent_today: "You've already sent a message today<br><small>Please come back tomorrow</small>",
        success: "Message sent successfully!<br><small>Thank you for one message per day</small>",
        error_empty: "Please write your message!",
        sending: "Sending..."
      },
      ja: {
        title: "ãŠå•ã„åˆã‚ã›",
        subtitle: "1æ—¥1å›ã®ã¿é€ä¿¡å¯èƒ½ã§ã™<br>é‡è¦ãªå†…å®¹ã®ã¿ãŠé¡˜ã„ã—ã¾ã™",
        placeholder: "ä½•ã‹ã‚ã‚Šã¾ã—ãŸã‹ï¼Ÿ",
        send: "é€ä¿¡ã™ã‚‹",
        sent_today: "ä»Šæ—¥ã¯ã™ã§ã«é€ä¿¡æ¸ˆã¿ã§ã™<br><small>æ˜æ—¥ã¾ãŸãŠè¶Šã—ãã ã•ã„</small>",
        success: "æ­£å¸¸ã«é€ä¿¡ã•ã‚Œã¾ã—ãŸï¼<br><small>1æ—¥1å›ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™</small>",
        error_empty: "å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼",
        sending: "é€ä¿¡ä¸­..."
      }
    };

    // í˜„ì¬ ì–¸ì–´ (URL íŒŒë¼ë¯¸í„° ?lang=en ë˜ëŠ” localStorage)
    function getLang() {
      const params = new URLSearchParams(location.search);
      const urlLang = params.get('lang');
      if (urlLang && translations[urlLang]) return urlLang;
      return localStorage.getItem('userLang') || 'ko';
    }

    function setLang(lang) {
      localStorage.setItem('userLang', lang);
      location.search = `?lang=${lang}`;   // URLë„ ì˜ˆì˜ê²Œ ìœ ì§€
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì–¸ì–´ ì ìš©
    function applyLanguage() {
      const lang = getLang();
      document.documentElement.lang = lang;
      
      document.querySelectorAll('[data-t]').forEach(el => {
        const key = el.getAttribute('data-t');
        if (key === "placeholder") {
          el.placeholder = translations[lang][key];
        } else if (key === "title") {
          document.title = translations[lang][key] + " | Contact";
          el.textContent = translations[lang][key];
        } else if (key === "send") {
          document.getElementById("sendBtn").textContent = translations[lang][key];
        } else {
          el.innerHTML = translations[lang][key] || el.innerHTML;
        }
      });
      // ì–¸ì–´ ë²„íŠ¼ í™œì„±í™” í‘œì‹œ
      document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.toggle('active', btn.textContent.trim() === 
          (lang === 'ko' ? 'í•œêµ­ì–´' : lang === 'en' ? 'EN' : 'æ—¥æœ¬èª'));
      });
    }

    function markAsSent() {
      localStorage.setItem(STORAGE_KEY, getToday());
    }
    // í•˜ë£¨ 1íšŒ ì œí•œ + ë‹¤êµ­ì–´ ë©”ì‹œì§€
    const STORAGE_KEY = "daily_email_sent_date";
    function getToday() { return new Date().toISOString().split('T')[0]; }
    // ì´ë¯¸ ì˜¤ëŠ˜ ë³´ëƒˆëŠ”ì§€ ì²´í¬
    function checkAlreadySent() { return localStorage.getItem(STORAGE_KEY) === getToday(); }
    // ì˜¤ëŠ˜ ë³´ëƒˆë‹¤ê³  ê¸°ë¡
    function markAsSent() { localStorage.setItem(STORAGE_KEY, getToday()); }

    // ì´ˆê¸° ìƒíƒœ ì„¤ì •
    window.onload = function() {
      applyLanguage();
      if (checkAlreadySent()) {
        document.getElementById("status").className = "warning";
        document.getElementById("status").innerHTML = translations[getLang()].sent_today;
        document.getElementById("sendBtn").disabled = true;
      }
    };

    function sendEmail() {
      const message = document.getElementById("message").value.trim();
      const status = document.getElementById("status");
      const button = document.getElementById("sendBtn");

      if (!message) {
        status.className = "error";
        status.textContent = "ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”!";
        return;
      }

      function sendEmail() {
      const lang = getLang();
      const message = document.getElementById("message").value.trim();
      const status = document.getElementById("status");
      const button = document.getElementById("sendBtn");

      if (!message) { status.className = "error"; status.textContent = translations[lang].error_empty; return; }
      if (checkAlreadySent()) { status.className = "warning"; status.innerHTML = translations[lang].sent_today; return; }

      status.className = "loading";
      status.textContent = translations[lang].sending;
      button.disabled = true;

      // EmailJS_Part
      emailjs.send("service_u2vsen1", "template_vqxgr1v", {
        message: message,
        to_email: "bradgosy@gmail.com"
      }).then(() => {
        markAsSent();
        status.className = "success";
        status.innerHTML = translations[lang].success;
        document.getElementById("message").value = "";
        button.textContent = lang === 'ko' ? "ì˜¤ëŠ˜ ì „ì†¡ ì™„ë£Œ" : lang === 'en' ? "Sent Today" : "æœ¬æ—¥é€ä¿¡æ¸ˆ";
      }, () => {
        status.className = "error";
        status.textContent = "Failed. Please try again.";
      }).finally(() => {
        button.disabled = checkAlreadySent();
      });
    }

    // ì—”í„°í‚¤ë¡œ ì „ì†¡
    document.getElementById("message").addEventListener("keydown", function(e) {
      if (e.key === "Enter" && !e.shiftKey) {
        e.preventDefault();
        sendEmail();
      }
    });
  </script>
</body>
</html>